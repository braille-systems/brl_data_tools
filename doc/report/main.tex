% !TeX spellcheck = en_US
% !TeX program = xelatex

\documentclass[a4paper,14pt]{extarticle}
\usepackage[T2A, T1]{fontenc} % russian
\usepackage[english, russian]{babel} % russian

\usepackage{setspace} % set space between lines
% `setspace` moved from `styling`: https://tex.stackexchange.com/a/577582

% fonts
\usepackage{fontspec} % different fonts
\setmainfont{Times New Roman}
\usepackage{amsmath}
\usepackage{amssymb} %common math symbols
\usepackage{dsfont}

% utilities
\usepackage{lastpage} % reference last page: \pageref{LastPage}
\usepackage{amsthm} % theorems with proofs
\usepackage{mathtools} % xRightarrow, xrightleftharpoons, etc
\usepackage{array} % utils for tables
\usepackage{multirow} % multirow for tables
\usepackage{makecell} % utils for tables formatting
\usepackage{subfiles}
\usepackage[hyperfootnotes]{hyperref}
\hypersetup{pdfstartview=FitH,  linkcolor=blue, urlcolor=blue, colorlinks=true}
\usepackage{framed} % advanced frames, boxes
\usepackage{graphicx}
\usepackage{caption} % caption setup
\usepackage{subcaption} % captions for subfigures
\usepackage{color}
\usepackage{listings} % code chunks (with UTF-8 characters support)
\definecolor{dkgreen}{rgb}{0,0.6,0}
\lstset{language=Python,
    basicstyle=\small\ttfamily,
    stringstyle=\color{dkgreen},
    keywordstyle=\color{blue},
    commentstyle=\color{dkgreen},
    tabsize=2,
    breaklines=true,
    numbers=left,
    columns=fullflexible
}

\usepackage[backend=biber, bibstyle=gost-numeric, sorting=none, block=space]{biblatex}
\addbibresource{bibliography.bib}
\DeclareFieldFormat[inproceedings]{pagetotal}{\mkpagetotal[bookpagination]{#1}}
\renewbibmacro*{chapter+pages}{%
    \printfield{note}%
    \setunit{\bibpagespunct -}%
    \printfield{pagetotal}%
    \setunit{\bibpagespunct}%
    \printfield{pages}%
    \newunit}


% styling
\usepackage[left=30mm, top=20mm, right=10mm, bottom=20mm, nohead, footskip=10mm]{geometry}
\usepackage{float} % force pictures position
\floatstyle{plaintop} % force caption on top
\usepackage{enumitem} % itemize and enumerate with [noitemsep]
% \setlength{\parindent}{0pt} % no indents!
\usepackage{indentfirst} % indent even the first paragraph
\usepackage{chngcntr}
\counterwithin{figure}{section} % per section figure numbering
\counterwithin{table}{section}
\counterwithin{equation}{section}

\usepackage[center]{titlesec} % center section titles

\usepackage{fancyhdr} % header/footer styling (page numbering, etc)
\pagestyle{fancy}
\fancyhf{} % clear header/footer
\fancyhead{}
\renewcommand{\headrulewidth}{0pt}
\rhead{\small\thepage} % page numbering in the top right corner and smaller font

% misc
\graphicspath{{./img/}}
\newcommand{\myPictWidth}{\textwidth}
\newcommand{\phm}{\phantom{-}}
\newcommand{\nonumsection}[1]{
    \section*{#1}
    \addcontentsline{toc}{section}{\protect\numberline{}#1}%
}
\newtheorem{statement}{Утверждение}
\counterwithin{statement}{section}

\begin{document}
\subfile{titlepage}
\subfile{parts/abstract}
\tableofcontents
\newpage
\subfile{parts/intro}
\subfile{parts/problem}
\subfile{parts/pseudolabeling}
\subfile{parts/code}
\subfile{parts/experiments}
\subfile{parts/results}
\subfile{conclusion}

\newpage
\addcontentsline{toc}{section}{\protect\numberline{}Список использованных источников}
\printbibliography[title={Список использованных источников}]

\subfile{parts/appendix}


\end{document}